<html>
<body>
<p><font size = '10' face = 'Times New Roman'><strong>Пересечение луча со сферой</strong></font></p>
<p><font size = '5' face = 'Times New Roman'>Теперь у нас есть два уравнения: описывающее точки на сфере и описывающее точки на луче: 
<center><img src = "C:/Program Files (x86)/Qt Project/RayTracing/files/theory/img/formula_2.3.png"></center>
Пересекаются ли луч и сфера? Если да, то где? <br><br>
Предположим, что луч пересекается со сферой в точке <i>P</i>. Она есть и вдоль луча, и на поверхности сферы, значит, она должна удовлетворять обоим уравнениям. 
Обратите внимание, что единственная переменная в этих уравнениях — это параметр <i>t</i>, ведь <i>O</i>, <i>D</i>, <i>C</i> и <i>r</i> даны, а <i>P</i> — искомая точка. <br><br>
Так как <i>P</i> в обоих уравнениях — это одна и та же точка, можно подставить вместо нее в первом уравнении выражение для <i>P</i> из второго, что даст нам:
<center><img src = "C:/Program Files (x86)/Qt Project/RayTracing/files/theory/img/formula_2.4.png"></center>
Если мы можем найти значения <i>t</i>, удовлетворяющие этому уравнению, то сможем подставить их в уравнение луча для нахождения точек, в которых луч пересекает сферу.<br><br> 
Сейчас это уравнение выглядит очень громоздко, поэтому мы попробуем его упростить с помощью алгебраических действий.<br>
Во-первых, пусть <i>CO</i> = <i>O</i> – <i>C</i>. Тогда можно записать уравнение как: 
<center><img src = "C:/Program Files (x86)/Qt Project/RayTracing/files/theory/img/formula_2.5.png"></center>
Используя дистрибутивность скалярного произведения, разобьем его на составляющие: 
<center><img src = "C:/Program Files (x86)/Qt Project/RayTracing/files/theory/img/formula_2.6.png"></center>
Вынесение <i>t</i> за скалярные произведения и перемещение <i>r<sup>2</sup></i> на другую сторону уравнения дает нам: 
<center><img src = "C:/Program Files (x86)/Qt Project/RayTracing/files/theory/img/formula_2.7.png"></center>
Скалярное произведение двух векторов — это вещественное число, значит, каждое выражение между угловыми скобками тоже будет вещественным. 
Если дать им имена, то получится уже более знакомая форма: 
<center><img src = "C:/Program Files (x86)/Qt Project/RayTracing/files/theory/img/formula_2.8.png"></center>
Перед нами старое доброе квадратичное уравнение. Его решения — это значения параметра <i>t</i>, где луч пересекает сферу: 
<center><img src = "C:/Program Files (x86)/Qt Project/RayTracing/files/theory/img/formula_2.9.png"></center>
К счастью, это имеет геометрический смысл. Если помните, квадратичное уравнение может не иметь решений, иметь одно двойное решение или же два разных. 
Это определяется значением дискриминанта <i>b<sup>2</sup></i> – <i>4ac</i>. Эти варианты в точности соответствуют случаям, когда луч не пересекает сферу, 
проходит по касательной к сфере или пересекает ее насквозь (рис. 2.4).
<center><img src = "C:/Program Files (x86)/Qt Project/RayTracing/files/theory/img/2.4.png"></center>
<center><strong>Рис. 2.4.</strong> Геометрическая интерпретация квадратичного уравнения: нет решений, одно решение или два решения</center><br>
Как только мы нашли значение <i>t</i>, можно подставить его обратно в уравнение луча и получить точку пересечения <i>P</i>, соответствующую этому значению.
</font></p>
</body>
</html>